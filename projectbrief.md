# プロジェクト概要

<!-- 2025/3/17: メモリバンク初期化時に作成。既存のプロジェクト文書から情報を抽出して作成 -->

## プロジェクト名
TONゲーム (TON Game)

## 概要
TONゲームはTelegram Mini Appとして開発されるリズムゲームアプリケーションです。Web3ユーザー、ゲーマー、およびTelegramのアクティブなコミュニティメンバー向けに設計されています。このアプリはTCIM Open NetworkのRegular Web App SDKを活用し、ウォレット接続や暗号通貨要素などのWeb3機能と統合され、インタラクティブなUnity WebGLリズムゲームを組み込んでいます。

## 主な目的
ユーザーエンゲージメントを向上させることが主な目的です。これは以下の方法で実現します：
- インタラクティブなクエスト
- デイリーログイン報酬
- リアルタイムスコアトラッキング

## 技術スタック
- **フロントエンド**: 
  - Next.js 14 (App Router)
  - Tailwind CSS
  - TypeScript
  - Shadcn UI
  - Good Times フォント (Adobe Typekit)
- **バックエンド**: 
  - Next.js API Routes
  - Supabase (データベース、認証、RLS)
  - Clerk Auth & JWT
- **ゲーム統合**: 
  - Unity WebGL
- **外部サービス統合**:
  - Telegram OAuth & ボットコマンド
  - OpenAI API
  - 決済ゲートウェイ (Stripe / 暗号通貨ソリューション)
  - アナリティクス (Google Analytics / PostHog)
  - ファイルストレージ (AWS S3 または Supabase Storage)

## 主要機能
1. **ユーザー認証とセキュリティ**
   - Telegram OAuth、Supabase Auth、JWTによる安全なログイン
   - ロックメカニズムとSupabase RLSによるデータ保護

2. **クエスト管理**
   - クエストリスト表示 (Telegramグループ参加、ウォレット接続、Twitterアクションなど)
   - デイリーログインボーナスシステム
   - 管理者によるモデレーション (下書き、レビュー待ち、公開、拒否のステータス)

3. **ゲームプレイ統合**
   - Unity WebGLベースのインタラクティブなリズムゲーム
   - ゲーム選択からプレイへのシームレスな移行
   - ゲームセッションデータの保存 (スコア、進捗、ポイント消費)

4. **ランキングと進捗追跡**
   - クエストポイント蓄積に基づくリアルタイムランキング更新
   - APIエンドポイントを介したユーザー進捗と成績表示

5. **アプリ内ストア機能**
   - 獲得ポイントを使用したゲーム内アイテム購入
   - クエスト報酬マルチプライヤーやスコア改善強化などのアイテム
   - 管理者によるストアアイテムの追加/編集/削除

6. **管理者ダッシュボード (/admin)**
   - クエスト、ストアアイテム、ユーザー進捗、ランキング設定の完全管理
   - ユーザーエンゲージメントと購入統計のデータ分析ダッシュボード
   - 自動通知と動的メッセージングのためのTelegramボット管理

## ユーザーフロー
1. ユーザーはTelegramからTONゲームアプリを起動
2. Telegram OAuthによる認証画面でログイン
3. ホーム画面に動的なクエストリストとデイリーログインボーナスが表示される
4. ナビゲーションメニュー（ホーム、ランキング、プレイ、ストア、設定）でアプリ内を移動
5. プレイセクションでは中央に配置されたプレイボタンをクリック
6. 音楽選択画面からサウンドトラックを選択
7. Unity WebGLインターフェースでゲームをプレイ
8. ゲーム後、スコアがバックエンドに保存され、ランキングがリアルタイムで更新
9. ゲームプレイ、リーダーボードチェック、アプリ内ストアでの取引間をシームレスに移動

## 非機能要件
- **パフォーマンス**: モバイルデバイスで素早く読み込み（理想的には2-3秒以内）
- **セキュリティ**: HTTPSと安全なAPIエンドポイント、Supabaseによるデータ暗号化
- **コンプライアンス**: GDPRコンプライアンス、データ保持とプライバシーポリシーの厳守
- **ユーザビリティ**: モバイルファーストの最適化設計、明確なナビゲーション、タッチフレンドリーな要素

## 制約と前提条件
- Telegram Mini Appとして機能するため、モバイルデバイス向けに最適化
- Supabase、Telegram OAuth、外部サービス（Cloudflare、OpenAI API）の可用性とパフォーマンスに依存
- ユーザーはWeb3に精通し、一般的なゲームインターフェースに慣れていることを前提
- 将来の統合フェーズ（高度な音楽管理システムなど）はMVPの成功展開後に続く

## 実装計画
1. **環境セットアップ**: Node.js v20.2.1、Next.js 14、Gitリポジトリ、プロジェクト構造の設定
2. **フロントエンド開発**: Next.jsプロジェクト作成、Tailwind CSS設定、UI構築、ページ作成
3. **バックエンド開発**: APIエンドポイント作成、Supabase統合、認証実装
4. **統合**: フロントエンドとバックエンドの接続、Unity WebGLゲーム統合、Telegram OAuth連携
5. **デプロイ**: Next.jsアプリケーションのデプロイ設定、AWS S3バケット設定、CI/CDパイプライン確立
